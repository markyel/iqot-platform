# –ß–µ–∫–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ

### 1. –ú–∏–≥—Ä–∞—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
–í—Å–µ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –±–∏–ª–ª–∏–Ω–≥–∞ –∏–º–µ—é—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü:
- ‚úÖ `2026_01_23_000001_create_billing_settings_table.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable()`
- ‚úÖ `2026_01_23_000002_create_invoices_table.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable()`
- ‚úÖ `2026_01_23_000003_create_invoice_items_table.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable()`
- ‚úÖ `2026_01_23_000004_create_acts_table.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable()`
- ‚úÖ `2026_01_23_000005_create_act_items_table.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable()`
- ‚úÖ `2026_01_23_120000_add_signature_and_numbering_to_billing_settings.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasColumn()`

### 2. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–π (–ù–ï –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—É)
- ‚úÖ `2026_01_23_120000_add_signature_and_numbering_to_billing_settings.php`
  - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `Schema::table()` –≤–º–µ—Å—Ç–æ `Schema::create()`
  - –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
  - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º
  - **–ù–ï –£–î–ê–õ–Ø–ï–¢** —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–±–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞)
- ‚úÖ `2026_01_16_000003_add_default_tariff_plan_setting.php` - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `hasTable('tariff_plans')`
- ‚úÖ `2026_01_19_000002_add_pdf_fields_to_reports_table.php` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω–¥–µ–∫—Å–∞

---

## üìã –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω

### –®–∞–≥ 1: –ë—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)
```bash
ssh root@217.26.31.80
cd /var/www/iqot
mysqldump -u iqot_user -p'Ij8uBLVBf+hGJ7HBjxFRNg==' iqot | gzip > /tmp/backup_before_deploy_$(date +%Y%m%d_%H%M%S).sql.gz
ls -lh /tmp/backup_*.sql.gz
```

### –®–∞–≥ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞
```bash
# –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
cd /var/www/iqot
git pull origin main
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
composer install --no-dev --optimize-autoloader
```

### –®–∞–≥ 4: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π (–±–µ–∑–æ–ø–∞—Å–Ω–æ)
```bash
php artisan migrate --force
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
- –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º
- –ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü—ã —É–∂–µ –µ—Å—Ç—å - –ø—Ä–æ–ø—É—Å—Ç—è—Ç —Å–æ–∑–¥–∞–Ω–∏–µ
- –î–æ–±–∞–≤—è—Ç —Ç–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –≤ `billing_settings`
- **–ù–ï –£–î–ê–õ–Ø–¢** –Ω–∏–∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ

### –®–∞–≥ 5: –û—á–∏—Å—Ç–∫–∞ –∫–µ—à–∞
```bash
php artisan config:clear
php artisan route:clear
php artisan view:clear
php artisan cache:clear
```

### –®–∞–≥ 6: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
```bash
php artisan config:cache
php artisan route:cache
php artisan view:cache
```

---

## üö® –ß–¢–û –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–¢–¨

### ‚ùå –û–ü–ê–°–ù–´–ï –ö–û–ú–ê–ù–î–´ (–Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ):
```bash
# ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –ó–ê–ü–£–°–ö–ê–¢–¨:
php artisan migrate:fresh      # –£–¥–∞–ª—è–µ—Ç –í–°–ï —Ç–∞–±–ª–∏—Ü—ã
php artisan migrate:refresh     # –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç —Ç–∞–±–ª–∏—Ü—ã
php artisan migrate:reset       # –û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
php artisan db:wipe             # –£–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã

# ‚ùå –û–ü–ê–°–ù–´–ï –§–õ–ê–ì–ò:
php artisan migrate --path=... --step=...  # –ú–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—è–¥–∫–æ–º
```

### ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–´–ï –ö–û–ú–ê–ù–î–´:
```bash
php artisan migrate             # –¢–æ–ª—å–∫–æ –Ω–æ–≤—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏
php artisan migrate --force     # –¢–æ –∂–µ, –Ω–æ –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
php artisan migrate:status      # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–π
```

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
php artisan migrate:status
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—ã –±–∏–ª–ª–∏–Ω–≥–∞
```bash
mysql -u iqot_user -p'Ij8uBLVBf+hGJ7HBjxFRNg==' iqot -e "SHOW TABLES LIKE '%billing%'; SHOW TABLES LIKE '%invoice%'; SHOW TABLES LIKE '%act%';"
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```bash
mysql -u iqot_user -p'Ij8uBLVBf+hGJ7HBjxFRNg==' iqot -e "SELECT COUNT(*) as users FROM users;"
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
```bash
mysql -u iqot_user -p'Ij8uBLVBf+hGJ7HBjxFRNg==' iqot -e "DESCRIBE billing_settings;"
```

–î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –∫–æ–ª–æ–Ω–∫–∏:
- `signature_image`
- `stamp_image`
- `invoice_number_mask`
- `invoice_number_start`
- `invoice_number_current`

---

## üìû –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –û—Ç–∫–∞—Ç –º–∏–≥—Ä–∞—Ü–∏–π (—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–∞—Ä—Ç–∏–∏)
```bash
php artisan migrate:rollback --step=1
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
```bash
# –ù–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
mysql -u iqot_user -p'Ij8uBLVBf+hGJ7HBjxFRNg==' iqot < /tmp/backup_before_deploy_YYYYMMDD_HHMMSS.sql
```

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [x] –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ `CREATE TABLE` –∏–º–µ—é—Ç –ø—Ä–æ–≤–µ—Ä–∫—É `Schema::hasTable()`
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Schema::table()` —Å `hasColumn()`
- [x] –ù–µ—Ç –∫–æ–º–∞–Ω–¥ `DROP TABLE`, `TRUNCATE`, `DELETE` –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö
- [x] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–ø–∏–∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –ë–î

**–î–µ–ø–ª–æ–π –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ!**
