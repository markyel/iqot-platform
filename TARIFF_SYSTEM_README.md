# –°–∏—Å—Ç–µ–º–∞ —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ IQOT

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã IQOT.

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –£–ø—Ä–∞–≤–ª—è—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–º–∏ –ø–ª–∞–Ω–∞–º–∏ —Å —Ä–∞–∑–Ω—ã–º–∏ –ª–∏–º–∏—Ç–∞–º–∏ –∏ —Ü–µ–Ω–∞–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –°–ø–∏—Å—ã–≤–∞—Ç—å –∞–±–æ–Ω–µ–Ω—Ç—Å–∫—É—é –ø–ª–∞—Ç—É –µ–∂–µ–º–µ—Å—è—á–Ω–æ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ
- –í–∑–∏–º–∞—Ç—å –ø–ª–∞—Ç—É –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `tariff_plans`
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–Ω—ã—Ö –ø–ª–∞–Ω–∞—Ö:
- `code` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥ —Ç–∞—Ä–∏—Ñ–∞ (start, basic, extended, professional)
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `monthly_price` - –µ–∂–µ–º–µ—Å—è—á–Ω–∞—è –∞–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞
- `items_limit` - –ª–∏–º–∏—Ç –ø–æ–∑–∏—Ü–∏–π –≤ –∑–∞—è–≤–∫–∞—Ö (NULL = –±–µ–∑–ª–∏–º–∏—Ç)
- `reports_limit` - –ª–∏–º–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ç—á–µ—Ç–æ–≤ (NULL = –±–µ–∑–ª–∏–º–∏—Ç)
- `price_per_item_over_limit` - —Ü–µ–Ω–∞ –∑–∞ –ø–æ–∑–∏—Ü–∏—é —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞
- `price_per_report_over_limit` - —Ü–µ–Ω–∞ –∑–∞ –æ—Ç—á–µ—Ç —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞
- `features` - JSON —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º (–¥–ª—è –±—É–¥—É—â–µ–≥–æ)
- `is_active` - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ç–∞—Ä–∏—Ñ
- `sort_order` - –ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏

### –¢–∞–±–ª–∏—Ü–∞ `user_tariffs`
–°–≤—è–∑—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–∞—Ä–∏—Ñ–∞–º–∏ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:
- `user_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `tariff_plan_id` - ID —Ç–∞—Ä–∏—Ñ–Ω–æ–≥–æ –ø–ª–∞–Ω–∞
- `started_at` - –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–µ–π—Å—Ç–≤–∏—è
- `expires_at` - –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–¥–ª—è –ø–ª–∞—Ç–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤)
- `items_used` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ–∑–∏—Ü–∏–π –∑–∞ —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥
- `reports_used` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –æ—Ç—á–µ—Ç–æ–≤ –∑–∞ —Ç–µ–∫—É—â–∏–π –ø–µ—Ä–∏–æ–¥
- `is_active` - –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —Ç–∞—Ä–∏—Ñ
- `last_charged_at` - –¥–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è

## üì¶ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã

### 1. –°—Ç–∞—Ä—Ç (–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π)
- **–ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞**: 0 ‚ÇΩ/–º–µ—Å
- **–õ–∏–º–∏—Ç—ã**: –±–µ–∑–ª–∏–º–∏—Ç
- **–û–ø–ª–∞—Ç–∞**: 50 ‚ÇΩ –∑–∞ –ø–æ–∑–∏—Ü–∏—é, 100 ‚ÇΩ –∑–∞ –æ—Ç—á–µ—Ç

### 2. –ë–∞–∑–æ–≤—ã–π
- **–ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞**: 1,500 ‚ÇΩ/–º–µ—Å
- **–í–∫–ª—é—á–µ–Ω–æ**: 15 –ø–æ–∑–∏—Ü–∏–π, 5 –æ—Ç—á–µ—Ç–æ–≤
- **–°–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞**: 40 ‚ÇΩ/–ø–æ–∑–∏—Ü–∏—è, 80 ‚ÇΩ/–æ—Ç—á–µ—Ç

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π
- **–ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞**: 3,500 ‚ÇΩ/–º–µ—Å
- **–í–∫–ª—é—á–µ–Ω–æ**: 50 –ø–æ–∑–∏—Ü–∏–π, 15 –æ—Ç—á–µ—Ç–æ–≤
- **–°–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞**: 35 ‚ÇΩ/–ø–æ–∑–∏—Ü–∏—è, 70 ‚ÇΩ/–æ—Ç—á–µ—Ç

### 4. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π
- **–ê–±–æ–Ω–µ–Ω—Ç—Å–∫–∞—è –ø–ª–∞—Ç–∞**: 10,000 ‚ÇΩ/–º–µ—Å
- **–í–∫–ª—é—á–µ–Ω–æ**: 200 –ø–æ–∑–∏—Ü–∏–π, 50 –æ—Ç—á–µ—Ç–æ–≤
- **–°–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞**: 30 ‚ÇΩ/–ø–æ–∑–∏—Ü–∏—è, 60 ‚ÇΩ/–æ—Ç—á–µ—Ç

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –ú–æ–¥–µ–ª–∏

#### `App\Models\TariffPlan`
–ú–æ–¥–µ–ª—å —Ç–∞—Ä–∏—Ñ–Ω–æ–≥–æ –ø–ª–∞–Ω–∞ —Å –º–µ—Ç–æ–¥–∞–º–∏:
- `isFree()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–æ—Å—Ç–∏
- `hasLimits()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ª–∏–º–∏—Ç–æ–≤
- `hasFeature($feature)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ñ—É–Ω–∫—Ü–∏–∏
- `findByCode($code)` - –ø–æ–∏—Å–∫ –ø–æ –∫–æ–¥—É
- `getStartTariff()` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞

#### `App\Models\UserTariff`
–ú–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –º–µ—Ç–æ–¥–∞–º–∏:
- `canCreateRequest($itemsCount)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
- `calculateRequestCost($itemsCount)` - —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∑–∞—è–≤–∫–∏
- `canOpenReport()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –æ—Ç—á–µ—Ç–∞
- `useItems($count)` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏–∏
- `useReport()` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
- `resetLimits()` - —Å–±—Ä–æ—Å–∏—Ç—å –ª–∏–º–∏—Ç—ã
- `extendForMonth()` - –ø—Ä–æ–¥–ª–∏—Ç—å –Ω–∞ –º–µ—Å—è—Ü

#### `App\Models\User` (—Ä–∞—Å—à–∏—Ä–µ–Ω)
–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã:
- `getActiveTariff()` - –ø–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–π —Ç–∞—Ä–∏—Ñ
- `getTariffPlan()` - –ø–æ–ª—É—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω
- `canCreateRequestWithItems($count)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
- `calculateRequestCostWithTariff($count)` - —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Å —É—á–µ—Ç–æ–º —Ç–∞—Ä–∏—Ñ–∞
- `assignTariff($tariffPlan)` - –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ
- `switchTariff($tariffPlan)` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ

### –°–µ—Ä–≤–∏—Å—ã

#### `App\Services\TariffService`
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞–º–∏:
- `assignStartTariffToNewUser($user)` - –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ –Ω–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- `renewExpiredTariffs()` - –æ–±–Ω–æ–≤–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–µ —Ç–∞—Ä–∏—Ñ—ã
- `downgradeToStartTariff($user, $reason)` - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ
- `switchUserTariff($user, $tariffPlan)` - –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ
- `useRequestLimits($user, $itemsCount)` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- `useReportLimits($user)` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç—ã –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –æ—Ç—á–µ—Ç–∞
- `getUserLimitsInfo($user)` - –ø–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏–º–∏—Ç–∞—Ö
- `checkRequestCreationAbility($user, $itemsCount)` - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏

### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

#### `App\Http\Controllers\TariffController`
–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–ª—è –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞:
- `index()` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ "–ú–æ–π —Ç–∞—Ä–∏—Ñ"
- `switch(Request $request)` - –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞

### –ö–æ–º–∞–Ω–¥—ã Artisan

#### `php artisan tariffs:renew`
–ï–∂–µ–º–µ—Å—è—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤:
- –ù–∞—Ö–æ–¥–∏—Ç –∏—Å—Ç–µ–∫—à–∏–µ —Ç–∞—Ä–∏—Ñ—ã
- –°–ø–∏—Å—ã–≤–∞–µ—Ç –∞–±–æ–Ω–µ–Ω—Ç—Å–∫—É—é –ø–ª–∞—Ç—É
- –û–±–Ω—É–ª—è–µ—Ç –ª–∏–º–∏—Ç—ã
- –ü—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –ø–µ—Ä–∏–æ–¥
- –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron** (–¥–æ–±–∞–≤–∏—Ç—å –≤ `app/Console/Kernel.php`):
```php
protected function schedule(Schedule $schedule)
{
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–æ–≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 00:00
    $schedule->command('tariffs:renew')->daily();
}
```

## üé® –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
**URL**: `/cabinet/tariff`

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:
- –¢–µ–∫—É—â–∏–π —Ç–∞—Ä–∏—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã (–ø–æ–∑–∏—Ü–∏–∏ –∏ –æ—Ç—á–µ—Ç—ã) —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞–º–∏
- –û—Å—Ç–∞–≤—à–∏–µ—Å—è –¥–Ω–∏ –¥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –í—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Filament
**URL**: `/admin/tariff-plans`

–§—É–Ω–∫—Ü–∏–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞–º–∏ –∏ —Ü–µ–Ω–∞–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
- –ê–∫—Ç–∏–≤–∞—Ü–∏—è/–¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Ç–∞—Ä–∏—Ñ–æ–≤

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞—è–≤–æ–∫

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞—è–≤–∫–∏

```php
use App\Services\TariffService;

$tariffService = app(TariffService::class);
$user = auth()->user();
$itemsCount = count($requestItems);

// –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
$ability = $tariffService->checkRequestCreationAbility($user, $itemsCount);

if (!$ability['can_create']) {
    return back()->with('error', $ability['reason']);
}

// –ï—Å–ª–∏ –µ—Å—Ç—å –ø–ª–∞—Ç–∞ —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞
if ($ability['cost'] > 0) {
    // –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
    $message = "–°—Ç–æ–∏–º–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏: {$ability['cost']} ‚ÇΩ";
}
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

```php
// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏
$tariffService->useRequestLimits($user, $itemsCount);

// –ï—Å–ª–∏ –±—ã–ª–∞ –ø–ª–∞—Ç–∞ —Å–≤–µ—Ä—Ö –ª–∏–º–∏—Ç–∞
if ($ability['cost'] > 0) {
    $user->decrement('balance', $ability['cost']);
}
```

## üöÄ –ó–∞–ø—É—Å–∫ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏
```bash
php artisan migrate
```

### 2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ç–∞—Ä–∏—Ñ—ã
```bash
php artisan db:seed --class=TariffPlansSeeder
```

### 3. –ù–∞–∑–Ω–∞—á—å—Ç–µ —Å—Ç–∞—Ä—Ç–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
```php
use App\Services\TariffService;
use App\Models\User;

$tariffService = app(TariffService::class);

User::whereDoesntHave('tariffs')->each(function ($user) use ($tariffService) {
    $tariffService->assignStartTariffToNewUser($user);
});
```

### 4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ cron –¥–ª—è –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
–î–æ–±–∞–≤—å—Ç–µ –≤ `app/Console/Kernel.php`:
```php
protected function schedule(Schedule $schedule)
{
    $schedule->command('tariffs:renew')->daily();
}
```

–ó–∞–ø—É—Å—Ç–∏—Ç–µ cron:
```bash
* * * * * cd /path-to-your-project && php artisan schedule:run >> /dev/null 2>&1
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∞—Ä–∏—Ñ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```php
$user = auth()->user();
$activeTariff = $user->getActiveTariff();

if ($activeTariff) {
    $tariffPlan = $activeTariff->tariffPlan;
    echo "–¢–∞—Ä–∏—Ñ: {$tariffPlan->name}";
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –ø–æ–∑–∏—Ü–∏–π: {$activeTariff->items_used} / {$tariffPlan->items_limit}";
}
```

### –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–∞—Ä–∏—Ñ

```php
use App\Services\TariffService;
use App\Models\TariffPlan;

$tariffService = app(TariffService::class);
$user = auth()->user();
$newTariff = TariffPlan::findByCode('professional');

try {
    $tariffService->switchUserTariff($user, $newTariff);
    echo "–¢–∞—Ä–∏—Ñ —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!";
} catch (\Exception $e) {
    echo "–û—à–∏–±–∫–∞: " . $e->getMessage();
}
```

## üîÆ –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:
- –ì—Ä—É–ø–ø–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ (—Ä–∞–∑–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≥—Ä—É–ø–ø—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∞—Ä–∏—Ñ–æ–≤)
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤ –≤ PDF
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ä–∏–≥–∏–Ω–∞–ª–æ–≤ –ö–ü/—Å—á–µ—Ç–æ–≤
- API –¥–æ—Å—Ç—É–ø
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–ª–µ `features` –≤ —Ç–∞—Ä–∏—Ñ–Ω–æ–º –ø–ª–∞–Ω–µ.

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- –ú–∏–≥—Ä–∞—Ü–∏–∏: `database/migrations/*_tariff_*.php`
- –ú–æ–¥–µ–ª–∏: `app/Models/TariffPlan.php`, `app/Models/UserTariff.php`
- –°–µ—Ä–≤–∏—Å: `app/Services/TariffService.php`
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä: `app/Http/Controllers/TariffController.php`
- View: `resources/views/cabinet/tariff/index.blade.php`
- Filament —Ä–µ—Å—É—Ä—Å: `app/Filament/Admin/Resources/TariffPlanResource.php`
- –ö–æ–º–∞–Ω–¥–∞: `app/Console/Commands/RenewUserTariffsCommand.php`
- Seeder: `database/seeders/TariffPlansSeeder.php`

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 16.01.2026
**–í–µ—Ä—Å–∏—è**: 1.0
